{"remainingRequest":"/Users/arqnet/Desktop/tro-emsig/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/arqnet/Desktop/tro-emsig/src/views/Projects.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/arqnet/Desktop/tro-emsig/src/views/Projects.vue","mtime":1566455821000},{"path":"/Users/arqnet/Desktop/tro-emsig/node_modules/cache-loader/dist/cjs.js","mtime":1615148347494},{"path":"/Users/arqnet/Desktop/tro-emsig/node_modules/babel-loader/lib/index.js","mtime":1615147414521},{"path":"/Users/arqnet/Desktop/tro-emsig/node_modules/cache-loader/dist/cjs.js","mtime":1615148347494},{"path":"/Users/arqnet/Desktop/tro-emsig/node_modules/vue-loader/lib/index.js","mtime":1615147418198}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcFN0YXRlIH0gZnJvbSAndnVleCcKaW1wb3J0IHsgZGVsZXRlUHJvamVjdEJ5SWQgfSBmcm9tICcuLi9kYi9pbmRleGVkREIuanMnCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJycsCgogIGRhdGEgKCkgewogICAgcmV0dXJuIHsKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIGRibmFtZTogJycsCiAgICAgIHZlcnNpb246IDEsCiAgICAgIGRiOiAnJywKICAgICAgc3RvcmU6ICcnLAogICAgICBpbmRleDogJycsCiAgICAgIHR4OiAnJywKICAgICAgaG92ZXJlZDoge30sCiAgICAgIGNsaWNrZWQ6IHt9LAogICAgICBzZWxlY3RlZEZpbGU6IG51bGwKICAgIH0KICB9LAoKICBjb21wdXRlZDogewogICAgLi4ubWFwU3RhdGUoWydiYXNpYycsICdvcHRpb25zJywgJ3RlbXBsYXRlJywgJ3Byb2plY3RzJ10pLAogICAgYWxsUHJvamVjdHMgKCkgewogICAgICByZXR1cm4gdGhpcy5wcm9qZWN0cy5wcm9qZWN0cy5maWx0ZXIoaXRlbSA9PiBpdGVtLmlkICE9PSAnY3VycmVudFByb2plY3QnKQogICAgfQogIH0sCgogIGFzeW5jIGNyZWF0ZWQgKCkgewogICAgdGhpcy4kZ2EucGFnZSh0aGlzLiRyb3V0ZXIpCiAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnZ2V0UHJvamVjdHMnKQogIH0sCgogIG1ldGhvZHM6IHsKICAgIGFzeW5jIG9uTmV3ICgpIHsKICAgICAgYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ25ld1Byb2plY3QnKQogICAgICB0aGlzLmdhRXZlbnRDbGljaygnbmV3IHByb2plY3QnKQogICAgfSwKICAgIGFzeW5jIG9uRGVsZXRlIChpZCkgewogICAgICB0cnkgewogICAgICAgIGF3YWl0IHRoaXMuJGNvbmZpcm0oJ1RoaXMgd2lsbCBwZXJtYW5lbnRseSBkZWxldGUgdGhlIGZpbGUuIENvbnRpbnVlPycsICdXYXJuaW5nJywgewogICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICdPSycsCiAgICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAnQ2FuY2VsJywKICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJwogICAgICAgIH0pCiAgICAgICAgYXdhaXQgZGVsZXRlUHJvamVjdEJ5SWQoaWQpCiAgICAgICAgYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2dldFByb2plY3RzJykKICAgICAgICB0aGlzLmdhRXZlbnRDbGljaygnZGVsZXRlIHByb2plY3QnKQogICAgICAgIGlmICh0aGlzLnByb2plY3RzLnByb2plY3RzLmxlbmd0aCA+IDApIHsKICAgICAgICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdzZXRDdXJyZW50UHJvamVjdCcpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCduZXdQcm9qZWN0JykKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewoKICAgICAgfQogICAgfSwKCiAgICBhc3luYyBvbkxvYWQgKHByb2plY3QpIHsKICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3NldFByb2plY3QnLCBwcm9qZWN0KQogICAgICB0aGlzLmdhRXZlbnRDbGljaygnbG9hZCBwcm9qZWN0JykKICAgIH0sCiAgICBvblVwZGF0ZSAoKSB7CiAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCd1cGRhdGVQcm9qZWN0JywgdGhpcy5wcm9qZWN0cy5wcm9qZWN0KQogICAgfSwKICAgIG9uSG92ZXIgKHYpIHsKICAgICAgdGhpcy5ob3ZlcmVkID0geyAuLi52IH0KICAgIH0sCiAgICBvbkVkaXROYW1lICh2KSB7CiAgICAgIHRoaXMuY2xpY2tlZCA9IHsgLi4udiB9CiAgICB9LAogICAgb25VcGRhdGVOYW1lICgpIHsKICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3VwZGF0ZVByb2plY3QnLCB0aGlzLmNsaWNrZWQpCiAgICAgIHRoaXMuY2xpY2tlZCA9IHt9CiAgICB9LAogICAgZG93bmxvYWQgKHByb2plY3QpIHsKICAgICAgY29uc3QgZGF0YSA9IEpTT04uc3RyaW5naWZ5KHByb2plY3QpCiAgICAgIC8vIHJldHVybiBhbGVydChkYXRhKQogICAgICBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpCiAgICAgIGNvbnN0IGZpbGUgPSBuZXcgQmxvYihbZGF0YV0sIHsgdHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nIH0pCiAgICAgIGEuaHJlZiA9IFVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZSkKICAgICAgYS5kb3dubG9hZCA9IHByb2plY3QubmFtZQogICAgICBhLmRpc3BhdGNoRXZlbnQoCiAgICAgICAgbmV3IE1vdXNlRXZlbnQoYGNsaWNrYCwgewogICAgICAgICAgYnViYmxlczogdHJ1ZSwKICAgICAgICAgIGNhbmNlbGFibGU6IHRydWUsCiAgICAgICAgICB2aWV3OiB3aW5kb3cKICAgICAgICB9KQogICAgICApCiAgICAgIHRoaXMuZ2FFdmVudENsaWNrKCdkb3dubG9hZCBwcm9qZWN0JykKICAgIH0sCiAgICBvbkZpbGVTZWxlY3RlZCAoZSkgewogICAgICBjb25zdCBmaWxlID0gZS50YXJnZXQuZmlsZXNbMF0KICAgICAgY29uc3QgZmwgPSBuZXcgRmlsZVJlYWRlcigpCiAgICAgIGZsLnJlYWRBc1RleHQoZmlsZSkKICAgICAgZmwub25sb2FkID0gZSA9PiB7CiAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2ltcG9ydFByb2plY3QnLCBKU09OLnBhcnNlKGUudGFyZ2V0LnJlc3VsdCkpCiAgICAgICAgLy8g0KPQtNCw0LvQtdC90LjQtSDQt9Cw0LPRgNGD0LbQtdC90L3QvtCz0L4g0YTQsNC50LvQsCDQuNC3INC40L3RgtGD0L/QsAogICAgICAgIHRoaXMuJHJlZnMuZmlsZUlucHV0LnZhbHVlID0gJycKICAgICAgfQogICAgfSwKICAgIG9uSW1wb3J0UHJvamVjdCAoKSB7CiAgICAgIHRoaXMuJHJlZnMuZmlsZUlucHV0LmNsaWNrKCkKICAgICAgdGhpcy5nYUV2ZW50Q2xpY2soJ2ltcG9ydCBwcm9qZWN0JykKICAgIH0KCiAgfQp9Cg=="},{"version":3,"sources":["Projects.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"Projects.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"projects\">\n    <el-table\n      v-loading=\"loading\"\n      :data=\"allProjects\"\n      size=\"small\"\n      @cell-mouse-enter=\"onHover\"\n    >\n      <el-table-column\n        label=\"Name\"\n        prop=\"name\"\n      >\n        <template slot-scope=\"scope\">\n          <span @click.stop=\"onEditName(scope.row)\">\n            <span v-if=\"clicked.id === scope.row.id\">\n              <el-row :gutter=\"10\">\n                <el-col :span=\"18\">\n                  <el-input\n                    v-model=\"clicked.name\"\n                    size=\"mini\"\n                  />\n                </el-col>\n                <el-col :span=\"6\">\n                  <div class=\"name-actions\">\n                    <span\n                      class=\"name-actions name-actions--success\"\n                      @click.stop=\"onUpdateName\"\n                    >\n                      <i class=\"el-icon-check\" />\n                    </span>\n                    <span\n                      class=\"name-actions name-actions--cancel\"\n                      @click.stop=\"clicked = {}\"\n                    >\n                      <i class=\"el-icon-close\" />\n                    </span>\n                  </div>\n                </el-col>\n              </el-row>\n            </span>\n            <span v-else>\n              <span v-if=\"projects.project.id === scope.row.id\">\n                <strong>{{ scope.row.name }}</strong>\n              </span>\n              <span v-else>{{ scope.row.name }}</span>\n            </span>\n          </span>\n        </template>\n      </el-table-column>\n      <el-table-column\n        label=\"Actions\"\n        width=\"220\"\n      >\n        <template slot-scope=\"scope\">\n          <el-button\n            type=\"text\"\n            size=\"mini\"\n            @click=\"onLoad(scope.row)\"\n          >\n            Load\n            <i class=\"el-icon-upload2\" />\n          </el-button>\n          <el-button\n            type=\"text\"\n            size=\"mini\"\n            @click=\"download(scope.row)\"\n          >\n            Download\n            <i class=\"el-icon-download\" />\n          </el-button>\n          <el-button\n            type=\"text\"\n            size=\"mini\"\n            @click=\"onDelete(scope.row.id)\"\n          >\n            Delete\n            <i class=\"el-icon-delete\" />\n          </el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n    <div class=\"project-actions\">\n      <el-button\n        size=\"small\"\n        @click=\"onImportProject\"\n      >Import project</el-button>\n      <el-button\n        size=\"small\"\n        type=\"success\"\n        @click=\"onNew\"\n      >New project</el-button>\n      <input\n        ref=\"fileInput\"\n        style=\"display: none;\"\n        type=\"file\"\n        @change=\"onFileSelected\"\n      >\n    </div>\n    <div class=\"desc\">\n      <p>Your changes and your projects only get stored in your browser's cache. Clearing your browsing data will result in losing your projects.</p>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex'\nimport { deleteProjectById } from '../db/indexedDB.js'\n\nexport default {\n  name: '',\n\n  data () {\n    return {\n      loading: false,\n      dbname: '',\n      version: 1,\n      db: '',\n      store: '',\n      index: '',\n      tx: '',\n      hovered: {},\n      clicked: {},\n      selectedFile: null\n    }\n  },\n\n  computed: {\n    ...mapState(['basic', 'options', 'template', 'projects']),\n    allProjects () {\n      return this.projects.projects.filter(item => item.id !== 'currentProject')\n    }\n  },\n\n  async created () {\n    this.$ga.page(this.$router)\n    this.$store.dispatch('getProjects')\n  },\n\n  methods: {\n    async onNew () {\n      await this.$store.dispatch('newProject')\n      this.gaEventClick('new project')\n    },\n    async onDelete (id) {\n      try {\n        await this.$confirm('This will permanently delete the file. Continue?', 'Warning', {\n          confirmButtonText: 'OK',\n          cancelButtonText: 'Cancel',\n          type: 'warning'\n        })\n        await deleteProjectById(id)\n        await this.$store.dispatch('getProjects')\n        this.gaEventClick('delete project')\n        if (this.projects.projects.length > 0) {\n          await this.$store.dispatch('setCurrentProject')\n        } else {\n          this.$store.dispatch('newProject')\n        }\n      } catch (err) {\n\n      }\n    },\n\n    async onLoad (project) {\n      this.$store.dispatch('setProject', project)\n      this.gaEventClick('load project')\n    },\n    onUpdate () {\n      this.$store.dispatch('updateProject', this.projects.project)\n    },\n    onHover (v) {\n      this.hovered = { ...v }\n    },\n    onEditName (v) {\n      this.clicked = { ...v }\n    },\n    onUpdateName () {\n      this.$store.dispatch('updateProject', this.clicked)\n      this.clicked = {}\n    },\n    download (project) {\n      const data = JSON.stringify(project)\n      // return alert(data)\n      const a = document.createElement('a')\n      const file = new Blob([data], { type: 'application/json' })\n      a.href = URL.createObjectURL(file)\n      a.download = project.name\n      a.dispatchEvent(\n        new MouseEvent(`click`, {\n          bubbles: true,\n          cancelable: true,\n          view: window\n        })\n      )\n      this.gaEventClick('download project')\n    },\n    onFileSelected (e) {\n      const file = e.target.files[0]\n      const fl = new FileReader()\n      fl.readAsText(file)\n      fl.onload = e => {\n        this.$store.dispatch('importProject', JSON.parse(e.target.result))\n        // Удаление загруженного файла из интупа\n        this.$refs.fileInput.value = ''\n      }\n    },\n    onImportProject () {\n      this.$refs.fileInput.click()\n      this.gaEventClick('import project')\n    }\n\n  }\n}\n</script>\n\n<style lang=\"scss\">\n@import '../assets/scss/variables';\n\n.project-actions {\n  margin-top: 20px;\n  text-align: right;\n}\n.name-actions {\n  padding: 2px 3px;\n  cursor: pointer;\n  border-radius: 2px;\n  + .name-actions {\n    margin-left: 2px;\n  }\n  &--success {\n    background-color: $color-success;\n    i {\n      color: #fff;\n    }\n  }\n  &--cancel {\n    background-color: $color-danger;\n    i {\n      color: #fff;\n    }\n  }\n}\n</style>\n"]}]}